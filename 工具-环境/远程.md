---
title: "服务器+SSH"
date: 2025-08-20
categories:
  - utils
tags:
  - 远程
---

# ssh登录

1. 常规账号密码登录，风险高
   `ssh username@x.x.x.x` password
2. ssh密钥登录，连接服务器的时候本地私钥生成一个签名，服务器会用公钥去验证签名是否正确
   `ssh prod`

# 生成ssh密钥

选择 ED25519 SSH 密钥

> 综合安全，性能，密钥长度综合考虑的行业首选密钥

```shell
# 生成密钥 -t指定密钥类型 -C添加注释
ssh-keygen -t ed25519 -C "your_email@example.com"
# 选择密钥保存位置和两次密钥密码-无特殊需求直接三个回车

cat ~/.ssh/id_ed25519.pub
```

# 客户端配置

配置文件位置：``~/.ssh/config`

文件内容

```
Host prod 																别名
    HostName 10.10.10.10									服务器地址
    User deploy														服务器用户
    Port 22																服务器ssh端口,默认22
    IdentityFile ~/.ssh/id_ed25519				客户端私钥位置
    IdentitiesOnly yes										只使用IdentityFile指定的私钥进行签名
    ServerAliveInterval 60								每隔60秒发送一次信号维持连接
    ServerAliveCountMax 3									连续三次服务器没有响应ServerAliveInterval则断开连接
    StrictHostKeyChecking yes    					防 MITM，可选，验证服务器签名
    
Host test
    HostName x.x.x.x
    User root
    IdentityFile ~/.ssh/id_ed25519
    IdentitiesOnly yes
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

# 服务器配置

## 将公钥写入服务器配置

需要将公钥内容写入服务器端`~/.ssh/authorized_keys`文件,格式为：`ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIL... user@laptop`

* 一键写入
  `ssh-copy-id user@server_ip` 
  谨慎使用会将客户端所有可用公钥拷贝到
* 手动写入
* `cat id_ed25519.pub | ssh user@server \
    "mkdir -p ~/.ssh && chmod 700 ~/.ssh && \
     cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys"`

## ssh配置文件设置

不用修改配置也可以正常使用了

`sudo vim /etc/ssh/sshd_config`

```
PubkeyAuthentication yes  								# 默认开启
AuthorizedKeysFile .ssh/authorized_keys		# 默认使用的公钥文件位置
PasswordAuthentication no     						# 建议关闭密码登录-可选
PermitRootLogin no            						# 禁止 root 直接登录-可选
```

`sudo systemctl restart sshd`

# 云服务器

阿里云安全中心：https://home.console.aliyun.com/home/dashboard/securitycenter

阿里云服务器告警处理：

https://yundun.console.aliyun.com/?p=sas#/overview/home/cn-hangzhou

# 工具选择

* windows
vmware

* mac
VMware Fusion
UTM

**终端工具**

win
MobaXterm

mac
Tabby

